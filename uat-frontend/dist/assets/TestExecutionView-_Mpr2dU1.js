import{_,c as a,o as n,a as e,n as E,F as m,g as p,t as c,s as y,x as v,p as b,j as T,k as h,q as f,v as D,r as g,b as S,m as w}from"./index-C7sBCj21.js";const C={props:{testExecutions:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},methods:{getStatusClass(o){switch(o){case"Passed":return"badge badge-success";case"Failed":return"badge badge-danger";case"In Progress":return"badge badge-warning";default:return"badge badge-secondary"}}}},k={class:"table-responsive"},M={class:"table table-striped table-hover"},$={key:0},V={key:1},I=["onClick"];function P(o,t,r,d,i,u){return n(),a("div",k,[e("table",M,[t[2]||(t[2]=e("thead",{class:"thead-dark"},[e("tr",null,[e("th",null,"#"),e("th",null,"Test Case"),e("th",null,"Functionality"),e("th",null,"Status"),e("th",null,"Action")])],-1)),e("tbody",null,[r.loading?(n(),a("tr",$,t[0]||(t[0]=[e("td",{colspan:"5",class:"text-center"},[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"sr-only"},"Loading...")])],-1)]))):r.testExecutions.length===0?(n(),a("tr",V,t[1]||(t[1]=[e("td",{colspan:"5",class:"text-center"},"No test executions found.",-1)]))):E("",!0),(n(!0),a(m,null,p(r.testExecutions,(s,l)=>(n(),a("tr",{key:s.id},[e("td",null,c(l+1),1),e("td",null,c(s.title),1),e("td",null,c(s.functionality),1),e("td",null,[e("span",{class:y(u.getStatusClass(s.status))},c(s.status||"Pending"),3)]),e("td",null,[e("button",{class:"btn btn-primary btn-sm",onClick:W=>o.$emit("execute",s)},"Execute",8,I)])]))),128))])])])}const B=_(C,[["render",P],["__scopeId","data-v-2e096a22"]]),x=v(),F={props:["execution"],data(){return{executionData:{status:"in_progress",notes:"",completed_at:new Date().toISOString(),test_case:this.execution.id,tester:this.execution.assigned_user||null,steps:this.execution.steps.map(o=>({id:o.id,step_number:o.step_number,description:o.description,status:""}))},statusChoices:[]}},async mounted(){try{const o=await b.get("/status-choices/");this.statusChoices=o.data}catch(o){console.error("Error fetching status choices:",o)}},methods:{async submit(){if(!this.executionData.tester){x.error("Tester ID not found. Please log in again.");return}if(this.executionData.steps.some(t=>!t.status)){x.warning("Please select a status for all steps.");return}try{const t={status:this.executionData.status,notes:this.executionData.notes,completed_at:this.executionData.completed_at,test_case:this.executionData.test_case,tester:this.executionData.tester,steps:this.executionData.steps.map(d=>({id:d.id,status:d.status}))},r=await b.post("/test-executions/",t);this.$emit("save",r.data),x.success("Test execution submitted successfully!"),this.$emit("close")}catch(t){console.error("Error submitting test execution:",t),x.error("Failed to submit test execution. Please try again.")}}}},N={class:"modal-overlay"},q={class:"modal-content"},U={class:"form-group"},A=["value"],L={class:"form-group"},j={class:"step-label"},z=["onUpdate:modelValue"],O=["value"],G={class:"modal-footer"};function H(o,t,r,d,i,u){return n(),a("div",N,[e("div",q,[t[7]||(t[7]=e("h3",{class:"modal-title text-center text-primary"},"Execute Test",-1)),e("form",{onSubmit:t[3]||(t[3]=T((...s)=>u.submit&&u.submit(...s),["prevent"]))},[e("div",U,[t[4]||(t[4]=e("label",{class:"form-label"},"Execution Status",-1)),h(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>i.executionData.status=s),class:"form-control",required:""},[(n(!0),a(m,null,p(i.statusChoices,s=>(n(),a("option",{key:s.value,value:s.value},c(s.label),9,A))),128))],512),[[f,i.executionData.status]])]),e("div",L,[t[5]||(t[5]=e("label",{class:"form-label"},"Execution Notes",-1)),h(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=s=>i.executionData.notes=s),class:"form-control",rows:"3",placeholder:"Add execution notes...",required:""},null,512),[[D,i.executionData.notes]])]),(n(!0),a(m,null,p(i.executionData.steps,s=>(n(),a("div",{class:"form-group",key:s.id},[e("label",j,"Step "+c(s.step_number)+": "+c(s.description),1),h(e("select",{"onUpdate:modelValue":l=>s.status=l,class:"form-control",required:""},[(n(!0),a(m,null,p(i.statusChoices,l=>(n(),a("option",{key:l.value,value:l.value},c(l.label),9,O))),128))],8,z),[[f,s.status]])]))),128)),e("div",G,[e("button",{type:"button",class:"btn btn-danger",onClick:t[2]||(t[2]=s=>o.$emit("close"))},"Cancel"),t[6]||(t[6]=e("button",{type:"submit",class:"btn btn-success"},"Submit",-1))])],32)])])}const J=_(F,[["render",H],["__scopeId","data-v-85df4bb9"]]),K={components:{TestExecutionTable:B,TestExecutionModal:J},data(){return{testExecutions:[],selectedExecution:null,showModal:!1}},methods:{async fetchTestExecutions(){var o;try{const t=await b.get("/test-cases/");this.testExecutions=t.data}catch(t){console.error("Error fetching test executions:",((o=t.response)==null?void 0:o.data)||t.message)}},openExecutionModal(o){this.selectedExecution={...o},this.showModal=!0},closeModal(){this.showModal=!1,this.fetchTestExecutions()},async submitExecution({executionId:o,steps:t}){try{await b.post(`/test-executions/${o}/execute/`,{steps:t}),this.closeModal()}catch(r){console.error("Error submitting execution:",r)}}},mounted(){this.fetchTestExecutions()}},Q={class:"container mt-4"};function R(o,t,r,d,i,u){const s=g("TestExecutionTable"),l=g("TestExecutionModal");return n(),a("div",Q,[t[0]||(t[0]=e("h2",{class:"mb-4 text-center text-primary"},"Test Execution",-1)),S(s,{testExecutions:i.testExecutions,onExecute:u.openExecutionModal},null,8,["testExecutions","onExecute"]),i.showModal?(n(),w(l,{key:0,execution:i.selectedExecution,onClose:u.closeModal,onSave:u.submitExecution},null,8,["execution","onClose","onSave"])):E("",!0)])}const Y=_(K,[["render",R],["__scopeId","data-v-d72a760d"]]);export{Y as default};
