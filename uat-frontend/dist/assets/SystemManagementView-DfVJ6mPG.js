import{_,c as v,o as c,a as e,F as h,g as w,t as y,h as g,i as $,j as k,k as z,v as S,p as C,l as M,b as N,m as x,n as A,f as b}from"./index-DrsjAiDN.js";const E={class:"table table-striped"},V=["onClick"],D=["onClick"],O={__name:"SystemTable",props:{systems:Array,organizations:Array},setup(r){const u=r,m=i=>{if(!i||!u.organizations)return"N/A";const t=u.organizations.find(o=>o.id===i);return t?t.name:"N/A"};return(i,t)=>(c(),v("table",E,[t[0]||(t[0]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"System Name"),e("th",null,"Organization"),e("th",null,"Description"),e("th",null,"Actions")])],-1)),e("tbody",null,[(c(!0),v(h,null,w(r.systems,(o,d)=>(c(),v("tr",{key:o.id},[e("td",null,y(d+1),1),e("td",null,y(o.name),1),e("td",null,y(m(o.organization)),1),e("td",null,y(o.description||"N/A"),1),e("td",null,[e("button",{class:"btn btn-sm btn-warning me-2",onClick:s=>i.$emit("edit",o)},"Edit",8,V),e("button",{class:"btn btn-sm btn-danger",onClick:s=>i.$emit("delete",o.id)},"Delete",8,D)])]))),128))])]))}},B=_(O,[["__scopeId","data-v-dd87c0da"]]),U={class:"modal-overlay"},j={class:"modal-content"},q={class:"mb-3"},I={class:"mb-3"},T={class:"mb-3"},F=["value"],L={class:"d-flex justify-content-between"},P={type:"submit",class:"btn btn-primary"},G={__name:"SystemModal",props:{system:Object,organizations:Array},emits:["close","save"],setup(r,{emit:u}){const m=r,i=u,t=g({name:"",description:"",organization:null});$(()=>m.system,d=>{d?t.value={...d}:t.value={name:"",description:"",organization:null}},{immediate:!0});const o=()=>{i("save",t.value)};return(d,s)=>{var p,f;return c(),v("div",U,[e("div",j,[e("h3",null,y((p=r.system)!=null&&p.id?"Edit System":"Create System"),1),e("form",{onSubmit:k(o,["prevent"])},[e("div",q,[s[4]||(s[4]=e("label",{class:"form-label"},"System Name",-1)),z(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=l=>t.value.name=l),class:"form-control",required:""},null,512),[[S,t.value.name]])]),e("div",I,[s[5]||(s[5]=e("label",{class:"form-label"},"Description",-1)),z(e("textarea",{"onUpdate:modelValue":s[1]||(s[1]=l=>t.value.description=l),class:"form-control",rows:"3",required:""},null,512),[[S,t.value.description]])]),e("div",T,[s[6]||(s[6]=e("label",{class:"form-label"},"Organization",-1)),z(e("select",{"onUpdate:modelValue":s[2]||(s[2]=l=>t.value.organization=l),class:"form-control",required:""},[(c(!0),v(h,null,w(r.organizations,l=>(c(),v("option",{key:l.id,value:l.id},y(l.name),9,F))),128))],512),[[C,t.value.organization]])]),e("div",L,[e("button",{type:"button",class:"btn btn-secondary",onClick:s[3]||(s[3]=l=>d.$emit("close"))},"Cancel"),e("button",P,y((f=r.system)!=null&&f.id?"Update":"Create"),1)])],32)])])}}},H=_(G,[["__scopeId","data-v-a9e7a696"]]),J={class:"container"},K={__name:"SystemManagementView",setup(r){const u=g([]),m=g([]),i=g(!1),t=g(null),o=async()=>{var n;try{const a=await b.get("/systems/");u.value=a.data}catch(a){console.error("Error fetching systems:",a),((n=a.response)==null?void 0:n.status)===401&&(alert("Session expired. Please log in again."),window.location.href="/login")}},d=async()=>{try{const n=await b.get("/organizations/");m.value=n.data}catch(n){console.error("Error fetching organizations:",n)}},s=n=>{t.value=n?{...n}:{name:"",description:"",organization_id:null},i.value=!0},p=()=>{i.value=!1,t.value=null},f=async n=>{try{n.id?await b.put(`/systems/${n.id}/`,n):await b.post("/systems/",n),o(),p()}catch(a){console.error("Error saving system:",a)}},l=async n=>{if(confirm("Are you sure you want to delete this system?"))try{await b.delete(`/systems/${n}/`),o()}catch(a){console.error("Error deleting system:",a)}};return M(()=>{o(),d()}),(n,a)=>(c(),v("div",J,[a[1]||(a[1]=e("h2",null,"System Management",-1)),e("button",{onClick:a[0]||(a[0]=Q=>s(null)),class:"btn btn-primary mb-3"}," + Create System "),N(B,{systems:u.value,organizations:m.value,onEdit:s,onDelete:l},null,8,["systems","organizations"]),i.value?(c(),x(H,{key:0,system:t.value,organizations:m.value,onClose:p,onSave:f},null,8,["system","organizations"])):A("",!0)]))}},W=_(K,[["__scopeId","data-v-656d2186"]]);export{W as default};
